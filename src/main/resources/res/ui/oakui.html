

<!--
* Licensed to the Apache Software Foundation (ASF) under one
* or more contributor license agreements.  See the NOTICE file
* distributed with this work for additional information
* regarding copyright ownership.  The ASF licenses this file
* to you under the Apache License, Version 2.0 (the
* "License"); you may not use this file except in compliance
* with the License.  You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing,
* software distributed under the License is distributed on an
* "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
* KIND, either express or implied.  See the License for the
* specific language governing permissions and limitations
* under the License.
*
-->
<script type="text/javascript" src="/system/console/oakui/res/ui/angular-1.2.26.js"></script>
<script type="text/javascript" src="/system/console/oakui/res/ui/oakui.js"></script>
<style><!--
.segment_class_0 {
    background-color: rgb(165,0,38);
}
.segment_class_1 {
    background-color: rgb(215,48,39);
}
.segment_class_2 {
    background-color: rgb(244,109,67);
}
.segment_class_3 {
    background-color: rgb(253,174,97);
}
.segment_class_4 {
    background-color: rgb(254,224,144);
}
.segment_class_5 {
    background-color: rgb(224,243,248);
}
.segment_class_6 {
    background-color: rgb(171,217,233);
}
.segment_class_7 {
    background-color: rgb(116,173,209);
}
.segment_class_8 {
    background-color: rgb(69,117,180);
}
.segment_class_9 {
    background-color: rgb(49,54,149);
}
.segment_class_10 {
    background-color: rgb(49,54,209);
}
--></style>
<div id="content" ng-app="oakui" ng-controller="OakuiController" >
    <!-- status line -->
    <!--
    <p class="statline ui-state-highlight">{{migrationstotal}} Migrations and  {{backupstotal}} backups on this instance.</p>
-->

    <!-- table caption -->
    <div class="ui-widget-header ui-corner-top">
        <div class="buttonGroup" >
            <button ng-click="migFormNo = 1" class="ui-state-default ui-corner-all" style="min-width: 8em;">Lucene</button>
            <button ng-click="migFormNo = 2" class="ui-state-default ui-corner-all" style="min-width: 8em;">Something else</button>
            <button ng-click="migFormNo = 3" class="ui-state-default ui-corner-all" style="min-width: 8em;">Something Else again</button>
        </div>
    </div>

    <div  ng-show="migFormNo === 1" >
        <table id="luceneTable" class="nicetable" >
            <tr>
                <th class="content container">Index</th>
                <th class="content container">Files</th>
            </tr>
                    
            <tr ng-repeat="index in lucene.indexes " >
                <td>
                        Name: {{index.name}} <br>
                        Type: {{index.type}} <br>
                        reindex: {{index.reindex}} <br>
                        reindex count: {{index.reindexCount}} <br>
                        index path: {{index._indexPath}} <br>
                        commits: {{outputGenerations(index.files)}} <br>
                        <button ng-click="analyseCommit(index.oakui_path, index)"
                                class="ui-state-default ui-corner-all"
                                style="min-width: 8em;">Analyse Commit</button>
                </td>
                <td>
                    <a href="oakui/{{index.oakui_path}}/segments.gen.do.zip">Download index files</a>
                    <br>
                    <table id="luceneTable" class="nicetable" >
                        <tr>
                            <th class="content container">Name</th>
                            <th class="content container">Info</th>
                            <th class="content container">Size</th>
                            <th class="content container">Last Modified</th>
                            <th class="content container">Age</th>
                        </tr>
                        <tr ng-repeat="file in index.files | orderBy : '-jcr_lastModified' " >
                            <td>
                                <span class="{{file.segment_class}}" >{{file.name}}</span>
                            </td>
                            <td ng-if="isSegment(file.name)">Segment file</td>
                            <td ng-if="isNotSegment(file.name)">
                                Used by <span ng-repeat="segment in file.segments" class="{{segment.class}}" >{{segment.name}}, </span>
                            </td>
                            <td>
                                {{file.jcr_data[0].length}}
                            </td>
                            <td>
                                {{file.jcr_lastModified}}
                            </td>
                            <td>
                                {{outputAge(file.jcr_lastModified)}}
                            </td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>

    <div  ng-show="migFormNo === 2" >
        <table id="luceneTable" class="nicetable" >
            <tr>
                <th colspan="3" class="content container">Something else</th>
            </tr>
            <tr>
                <td colspan="3">Some other aspect of Oak.</td>
            </tr>
            <tr>
                <td></td>
                <td>
                    <div ng-repeat="path in startmigration.source_tenants.source  track by $index" >
                        <input ng-change="updateAoDMigration()" ng-model="startmigration.source_tenants.source[$index]" size="50">
                        <input  ng-change="updateAoDMigration()" ng-model="startmigration.source_tenants.tenants[$index]" size="50">
                        <button ng-click="addSourceTenantsToContainer($index)" class="ui-state-default ui-corner-all" > + </button>
                        <button ng-click="removeSourceTenantsFromContainer($index)" class="ui-state-default ui-corner-all" > - </button>
                    </div>
                </td>
            </tr>

        </table>
    </div>


    <div  ng-show="migFormNo === 3" >
        <table id="migrationTableGeneric" class="nicetable"  >
            <tr>
                <th colspan="3" class="content container">Something Else again</th>
            </tr>
            <tr>
                <td colspan="3">bla bla bla</td>
            </tr>
        </table>
    </div>
